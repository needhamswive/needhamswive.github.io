---
layout: single
classes: wide
---

{{ content }}

{% assign events = site.data %}
{% assign events-path-segments = page.events | split: "." %}
{% for segment in events-path-segments %}
  {% assign events = events[segment] %}
{% endfor %}
{% assign events = events | map: "name" %}

{% assign results = site.data %}
{% assign results-path-segments = page.results | split: "." %}
{% for segment in results-path-segments %}
  {% assign results = results[segment] %}
{% endfor %}

{% assign years = results | map: "year" | uniq | sort | reverse %}

{% assign first-result = results | first %}
{% assign multiple-divisions = first-result.division %}
{% if multiple-divisions %}
  {% assign divisions = results | map: "division" | uniq | sort %}
{% endif %}

{% if multiple-divisions %}
  {% include filter-division-event-year.html
    events = events
    divisions = divisions
    years = years %}
{% else %}
  {% include filter-event-year.html
    events = events
    years = years %}
{% endif %}

{% for year in years %}

{% assign results-for-year = results | where: "year", year %}

<div class="filter-section" data-option="year" data-section="{{ year }}">

<h2>{{ year }}</h2>

{% if multiple-divisions %}
  {% for division in divisions %}
    <div class="filter-section" data-option="division" data-section="{{ division }}">

    <h3>{{ division }}&nbsp;{{ page.division-suffix }}</h3>

    {% assign results-for-year-and-division = results-for-year | where: "division", division %}
    {% include event-results.html
      events = events
      results = results-for-year-and-division %}

    </div>
  {% endfor %}
{% else %}
  {% include event-results.html
    events = events
    results = results-for-year %}
{% endif %}

</div>

{% endfor %}
